REPORT Z.

TYPES : BEGIN OF TY_SPFLI,  "User defined internal table type
       CARRID TYPE SPFLI-CARRID,
       CONNID TYPE SPFLI-CONNID,
       COUNTRYFR TYPE SPFLI-COUNTRYFR,
       CITYFROM TYPE SPFLI-CITYFROM,
      END OF TY_SPFLI.

DATA : IT_SPFLI TYPE TABLE OF TY_SPFLI, "SPFLI internal table
       WA_SPFLI TYPE TY_SPFLI. "work area

TYPES : BEGIN OF TY_SFLIGHT,
        CARRID TYPE SFLIGHT-CARRID,
        CONNID TYPE SFLIGHT-CONNID,
        FLDATE TYPE SFLIGHT-FLDATE,
        PRICE TYPE SFLIGHT-PRICE,
      END OF TY_SFLIGHT.

DATA : IT_SFLIGHT TYPE TABLE OF TY_SFLIGHT, "SFLIGHT internal table
       WA_SFLIGHT TYPE TY_SFLIGHT.

DATA TCARRID TYPE SPFLI-CARRID.
SELECT-OPTIONS P_CARRID FOR TCARRID.

START-OF-SELECTION.
  SELECT CARRID
         CONNID
         COUNTRYFR
         CITYFROM
         FROM SPFLI "get SPFLI data
    INTO TABLE IT_SPFLI  WHERE CARRID IN P_CARRID.

IF NOT IT_SPFLI IS INITIAL .
  PERFORM DISPFROMSFLIGHT.
ELSE.
   MESSAGE E001(ZVK1) WITH 'No records exist for:'  P_CARRID.
ENDIF.

FORM DISPFROMSFLIGHT.
    SELECT  CARRID CONNID
            FLDATE
            PRICE FROM SFLIGHT INTO TABLE IT_SFLIGHT "get flight data
      FOR ALL ENTRIES IN IT_SPFLI WHERE CARRID = IT_SPFLI-CARRID.

LOOP AT IT_SFLIGHT INTO WA_SFLIGHT.
  WRITE :/ WA_SFLIGHT-CARRID.
  WRITE :/ WA_SFLIGHT-CONNID.
  WRITE :/ WA_SFLIGHT-FLDATE.
  WRITE :/ WA_SFLIGHT-PRICE.
ENDLOOP.

ENDFORM.