REPORT Z.

TYPES: BEGIN OF DEPTTYPE,
  DNAME  TYPE Z104329DEPT-DNAME,
  DEPTNO TYPE Z104329DEPT-DEPTNO,
  LOC    TYPE Z104329DEPT-LOC,
END OF DEPTTYPE.

TYPES: BEGIN OF EMPTYPE,
  EMPNO  TYPE Z104329EMP-EMPNO,
  ENAME  TYPE Z104329EMP-ENAME,
  DEPTNO TYPE Z104329EMP-DEPTNO,
END OF EMPTYPE.

DATA ITDEPT TYPE TABLE OF DEPTTYPE  INITIAL SIZE 0.
DATA ITEMP  TYPE TABLE OF EMPTYPE   INITIAL SIZE 0.

DATA WAEMP  TYPE EMPTYPE.
DATA WADEPT LIKE LINE OF ITDEPT.

DATA SDEPTNO TYPE Z104329DEPT-DEPTNO.
DATA SDNAME TYPE Z104329DEPT-DNAME.
DATA SLOC TYPE Z104329DEPT-LOC.


START-OF-SELECTION.
SELECT DNAME DEPTNO LOC
  FROM Z104329DEPT
  INTO TABLE ITDEPT.
IF SY-SUBRC = 0.
LOOP AT ITDEPT INTO WADEPT.
   WRITE: / WADEPT-DNAME,WADEPT-DEPTNO,WADEPT-LOC.
   HIDE WADEPT-DEPTNO.
ENDLOOP.
ENDIF.

AT LINE-SELECTION.
WRITE : 'WADEPT-DEPTNO:',WADEPT-DEPTNO.

SELECT EMPNO ENAME DEPTNO
  INTO TABLE ITEMP FROM Z104329EMP
WHERE DEPTNO = WADEPT-DEPTNO.

IF SY-SUBRC = 0.
  LOOP AT ITEMP INTO WAEMP.
      WRITE:/ WAEMP-EMPNO , WAEMP-ENAME ,WAEMP-DEPTNO.
  ENDLOOP.
ENDIF.