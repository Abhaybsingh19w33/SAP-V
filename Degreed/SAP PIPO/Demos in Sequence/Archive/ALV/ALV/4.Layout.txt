REPORT ZAT_ALV_DEMO04.

TYPE-POOLS : SLIS .
TABLES SPFLI.
*DATA DECLARATIONS
DATA : I_SPFLI TYPE TABLE OF SPFLI .
DATA : WA_SPFLI TYPE SPFLI .
*ALV DECLARATIONS
DATA : I_FCAT TYPE SLIS_T_FIELDCAT_ALV .
DATA : WA_FCAT TYPE SLIS_FIELDCAT_ALV .
DATA : V_POS TYPE I .
DATA : WA_LAYOUT TYPE SLIS_LAYOUT_ALV .
SELECT-OPTIONS : S_CARRID FOR SPFLI-CARRID.

START-OF-SELECTION .
  PERFORM GET_DATA .
  PERFORM CREATE_FCAT .
  PERFORM CREATE_LAYOUT.
  PERFORM DISPLAY_DATA .


FORM GET_DATA .
  SELECT * FROM SPFLI
      INTO TABLE I_SPFLI
       WHERE CARRID IN S_CARRID.
ENDFORM.                    " GET_DATA
FORM DISPLAY_DATA .

  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'
    EXPORTING
      I_CALLBACK_PROGRAM = SY-REPID
      IS_LAYOUT          = WA_LAYOUT
      IT_FIELDCAT        = I_FCAT
    TABLES
      T_OUTTAB           = I_SPFLI.
ENDFORM.                    " DISPLAY_DATA
FORM DISPLAY_DATA_LIST .
  CALL FUNCTION 'REUSE_ALV_GRID_DISPLAY'
    EXPORTING
      I_STRUCTURE_NAME = 'SPFLI'
    TABLES
      T_OUTTAB         = I_SPFLI.
  IF SY-SUBRC NE 0.
* MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
*         WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
  ENDIF.

ENDFORM.                    " DISPLAY_DATA_LIST
FORM CREATE_FCAT .
  V_POS = 1 .
  WA_FCAT-COL_POS = V_POS.
  WA_FCAT-FIELDNAME = 'CARRID' .
  WA_FCAT-SELTEXT_M = 'Airline' .
  WA_FCAT-HOTSPOT = 'X' .
  APPEND WA_FCAT TO I_FCAT .
  CLEAR WA_FCAT .

  V_POS = V_POS + 1.
  WA_FCAT-COL_POS = V_POS .
  WA_FCAT-FIELDNAME = 'CONNID' .
  WA_FCAT-SELTEXT_M = 'Flight Number' .
   WA_FCAT-HOTSPOT = 'X' .
  APPEND WA_FCAT TO I_FCAT .
  CLEAR WA_FCAT .


  V_POS = V_POS +  1.
  WA_FCAT-COL_POS = V_POS .
  WA_FCAT-FIELDNAME = 'COUNTRYFR' .
  WA_FCAT-SELTEXT_M = 'Country From' .
  APPEND WA_FCAT TO I_FCAT .
  CLEAR WA_FCAT .


  V_POS = V_POS +  1.
  WA_FCAT-COL_POS = V_POS .
  WA_FCAT-FIELDNAME = 'CITYFROM' .
  WA_FCAT-SELTEXT_M = 'Departure City' .
  APPEND WA_FCAT TO I_FCAT .
  CLEAR WA_FCAT .
ENDFORM.                    " CREATE_FCAT

FORM CREATE_LAYOUT .
WA_LAYOUT-ZEBRA = 'X' .
  WA_LAYOUT-COLWIDTH_OPTIMIZE = 'X' .
  WA_LAYOUT-EDIT = 'X' .
 " WA_LAYOUT-NO_VLINE = 'X' .
 " WA_LAYOUT-NO_HLINE = 'X' .

ENDFORM.                    " CREATE_LAYOUT