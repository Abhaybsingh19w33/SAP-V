REPORT ZAT_OOALV_DEMO04.

TYPES : BEGIN OF TY_SPFLI,  "User defined internal table type
          CARRID    TYPE SPFLI-CARRID,
          CONNID    TYPE SPFLI-CONNID,
          COUNTRYFR TYPE SPFLI-COUNTRYFR,
          CITYFROM  TYPE SPFLI-CITYFROM,
        END OF TY_SPFLI.
DATA:
  IT_SPFLI    TYPE TABLE OF TY_SPFLI,
  R_CONTAINER TYPE REF TO CL_GUI_CUSTOM_CONTAINER,
  R_GRID      TYPE REF TO CL_GUI_ALV_GRID,
  IT_FCAT     TYPE LVC_T_FCAT,
  WA_FCAT     TYPE LVC_S_FCAT.
DATA WA_LAYOUT TYPE LVC_S_LAYO.
DATA LS_SORT TYPE LVC_S_SORT.
DATA PT_SORT TYPE LVC_T_SORT.

SELECT CARRID CONNID COUNTRYFR CITYFROM FROM SPFLI
      INTO TABLE IT_SPFLI.

CALL SCREEN 100.

MODULE STATUS_0100 OUTPUT.
  CREATE OBJECT R_CONTAINER
    EXPORTING
      CONTAINER_NAME = 'CONTAINER'.

  CREATE OBJECT R_GRID
    EXPORTING
      I_PARENT = R_CONTAINER.

  WA_LAYOUT-GRID_TITLE = 'ALV Grid Title'.
  WA_LAYOUT-ZEBRA = 'X'.
  WA_LAYOUT-CWIDTH_OPT = 'X'.


  LS_SORT-SPOS = 1.
  LS_SORT-FIELDNAME = 'CARRID'.
  LS_SORT-UP = 'X'.
  LS_SORT-DOWN = SPACE.
  APPEND LS_SORT TO PT_SORT.


  WA_FCAT-COL_POS = '1' .
  WA_FCAT-FIELDNAME = 'CARRID' . "Field Name of the DB table
  WA_FCAT-SELTEXT = 'Airline' . "Col Heading to be displayed
  APPEND WA_FCAT TO IT_FCAT .
  CLEAR WA_FCAT .

  WA_FCAT-COL_POS = '2' .
  WA_FCAT-FIELDNAME = 'CONNID' .
  " WA_FCAT-TABNAME = 'IT_SPFLI' .
  WA_FCAT-SELTEXT = 'Flight Number' .
  WA_FCAT-HOTSPOT = 'X' .
  APPEND WA_FCAT TO IT_FCAT .
  CLEAR WA_FCAT .

  WA_FCAT-COL_POS = '3' .
  WA_FCAT-FIELDNAME = 'COUNTRYFR' .
  "WA_FCAT-REF_FIELDNAME = 'Country' .
  WA_FCAT-NO_OUT = 'X' .
  "WA_FCAT-REF_TABNAME = 'SPFLI' .
*  WA_FCAT-TABNAME = 'IT_SPFLI' .
  WA_FCAT-SELTEXT = 'Country From' .
*  WA_FCAT-EDIT = 'X' .
  APPEND WA_FCAT TO IT_FCAT .
  CLEAR WA_FCAT .

  WA_FCAT-COL_POS = '4' .
  WA_FCAT-FIELDNAME = 'CITYFROM' .
  WA_FCAT-TABNAME = 'IT_SPFLI' .
  WA_FCAT-SELTEXT = 'Departure City' .
  WA_FCAT-EMPHASIZE = 'C610'.
  APPEND WA_FCAT TO IT_FCAT .
  CLEAR WA_FCAT .

  CALL METHOD R_GRID->SET_TABLE_FOR_FIRST_DISPLAY
    EXPORTING
      IS_LAYOUT       = WA_LAYOUT
    CHANGING
      IT_SORT         = PT_SORT
      IT_FIELDCATALOG = IT_FCAT
      IT_OUTTAB       = IT_SPFLI.
ENDMODULE.


MODULE USER_COMMAND_0100 INPUT.
  CASE SY-UCOMM.
    WHEN 'BACK'.
      LEAVE TO SCREEN 0.
  ENDCASE.
ENDMODULE.